CREATE DATABASE HELLO29;
USE HELLO29;

CREATE TABLE STUDENTS(
	STUDENT_ID INT PRIMARY KEY,
    NAME VARCHAR(30),
    AGE INT
);
INSERT INTO students VALUES
(1, 'John', 20),
(2, 'Sara', 21),
(3, 'Mike', 22),
(4, 'Lily', 20),
(5, 'Tom', 23);

SELECT * FROM STUDENTS;

CREATE TABLE COURSES(
	COURSE_ID INT PRIMARY KEY,
    COURSE_NAME VARCHAR(20)
);

INSERT INTO courses VALUES
(101, 'Mathematics'),
(102, 'Physics'),
(103, 'Biology'),
(104, 'Chemistry');

SELECT * FROM COURSES;

CREATE TABLE ENROLLMENTS(
	ENROLLMENT_ID INT PRIMARY KEY,
    STUDENT_ID INT,
    COURSE_ID INT
);

INSERT INTO enrollments VALUES
(1, 1, 101),
(2, 2, 101),
(3, 2, 102),
(4, 3, 103),
(5, 4, 101);

SELECT * FROM ENROLLMENTS;

SELECT STUDENTS.NAME,COURSES.COURSE_NAME
FROM ENROLLMENTS
INNER JOIN STUDENTS
ON ENROLLMENTS.STUDENT_ID = STUDENTS.STUDENT_ID
INNER JOIN COURSES
ON COURSES.COURSE_ID = ENROLLMENTS.COURSE_ID;


SELECT S.NAME,C.COURSE_NAME
FROM ENROLLMENTS AS E
INNER JOIN STUDENTS AS S
ON E.STUDENT_ID = S.STUDENT_ID
INNER JOIN COURSES AS C
ON C.COURSE_ID = E.COURSE_ID;


SELECT COURSES.COURSE_NAME,STUDENTS.NAME
FROM COURSES
JOIN ENROLLMENTS
ON COURSES.COURSE_ID = ENROLLMENTS.COURSE_ID
JOIN STUDENTS
ON ENROLLMENTS.STUDENT_ID = STUDENTS.STUDENT_ID;

SELECT C.COURSE_NAME,S.NAME
FROM COURSES AS C
JOIN ENROLLMENTS AS E
ON C.COURSE_ID = E.COURSE_ID
JOIN STUDENTS AS S
ON E.STUDENT_ID = S.STUDENT_ID;

SELECT STUDENTS.NAME
FROM COURSES
INNER JOIN ENROLLMENTS
ON COURSES.COURSE_ID = ENROLLMENTS.COURSE_ID
INNER JOIN STUDENTS
ON ENROLLMENTS.STUDENT_ID = STUDENTS.STUDENT_ID
WHERE COURSES.COURSE_NAME = "Physics";

SELECT STUDENTS.NAME,COURSES.COURSE_NAME
FROM STUDENTS
LEFT JOIN ENROLLMENTS
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
LEFT JOIN COURSES
ON ENROLLMENTS.COURSE_ID = COURSES.COURSE_ID;

SELECT S.NAME,C.COURSE_NAME
FROM STUDENTS S
LEFT JOIN ENROLLMENTS E
ON S.STUDENT_ID = E.STUDENT_ID
LEFT JOIN COURSES C
ON E.COURSE_ID = C.COURSE_ID;

SELECT COURSES.COURSE_NAME,STUDENTS.NAME
FROM COURSES
LEFT JOIN ENROLLMENTS
ON COURSES.COURSE_ID = ENROLLMENTS.COURSE_ID
LEFT JOIN STUDENTS
ON ENROLLMENTS.STUDENT_ID = STUDENTS.STUDENT_ID;

SELECT C.COURSE_NAME,S.NAME
FROM COURSES AS C
LEFT JOIN ENROLLMENTS AS E
ON C.COURSE_ID = E.COURSE_ID
LEFT JOIN STUDENTS AS S
ON E.STUDENT_ID = S.STUDENT_ID;

SELECT STUDENTS.NAME,COURSES.COURSE_NAME
FROM STUDENTS
LEFT JOIN ENROLLMENTS
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
LEFT JOIN COURSES
ON ENROLLMENTS.COURSE_ID = COURSES.COURSE_ID
UNION
SELECT STUDENTS.NAME,COURSES.COURSE_NAME
FROM COURSES
LEFT JOIN ENROLLMENTS
ON COURSES.COURSE_ID = ENROLLMENTS.COURSE_ID
LEFT JOIN STUDENTS
ON ENROLLMENTS.STUDENT_ID = STUDENTS.STUDENT_ID;

SELECT S1.NAME,S2.NAME
FROM STUDENTS S1
INNER JOIN STUDENTS S2
ON S1.AGE = S2.AGE AND S1.STUDENT_ID < S2.STUDENT_ID;

SELECT COURSES.COURSE_NAME,COUNT(STUDENTS.NAME)
FROM COURSES
INNER JOIN ENROLLMENTS
ON COURSES.COURSE_ID = ENROLLMENTS.COURSE_ID
INNER JOIN STUDENTS
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
GROUP BY COURSES.COURSE_NAME;

SELECT COURSES.COURSE_NAME,COUNT(ENROLLMENTS.STUDENT_ID)
FROM COURSES
INNER JOIN ENROLLMENTS
ON COURSES.COURSE_ID = ENROLLMENTS.COURSE_ID
GROUP BY COURSES.COURSE_NAME;

SELECT STUDENTS.NAME,COUNT(ENROLLMENTS.COURSE_ID)
FROM STUDENTS
INNER JOIN ENROLLMENTS
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
GROUP BY STUDENTS.NAME;

SELECT STUDENTS.NAME,COURSES.COURSE_NAME
FROM STUDENTS
INNER JOIN ENROLLMENTS
ON ENROLLMENTS.STUDENT_ID = STUDENTS.STUDENT_ID
INNER JOIN COURSES
ON ENROLLMENTS.COURSE_ID = COURSES.COURSE_ID
ORDER BY STUDENTS.NAME;
