CREATE DATABASE HELLO27;
USE HELLO27;

CREATE TABLE EMPDETAILS(
	ID INT PRIMARY KEY,
    NAME VARCHAR(30),
    SALARY INT
);
INSERT INTO EMPDETAILS VALUES (1,"JOHN",40000),(2,"ALEX",25000),(3,"SIMON",43000);
CREATE TABLE STATUS(
	ID INT PRIMARY KEY,
    NAME VARCHAR(30),
    STATUS VARCHAR(10)
);
INSERT INTO STATUS VALUES (1,"JOHN","MARIIRED"),(3,"SIMON","MARRIED"),(4,"STELLA","UNMARRIED");

SELECT * FROM EMPDETAILS;

SELECT * FROM STATUS;

SELECT EMPDETAILS.ID,EMPDETAILS.NAME,SALARY,STATUS
FROM EMPDETAILS
RIGHT JOIN STATUS
ON EMPDETAILS.ID = STATUS.ID;

SELECT STATUS.ID,STATUS.NAME,SALARY,STATUS
FROM EMPDETAILS
RIGHT JOIN STATUS
ON EMPDETAILS.ID = STATUS.ID;

CREATE TABLE T1(
	C1 VARCHAR(10),
    NAME VARCHAR(10),
    C2 VARCHAR(10)
);
INSERT INTO T1 VALUES ("BLUE","JOHN","RED"),("GREEN","ALEX","BLUE"),("RED","SIMON","GREEN");

SELECT * FROM T1;

SELECT B.NAME,A.NAME
FROM T1 AS A
JOIN T1 AS B
WHERE A.C1 = B.C2;

SELECT STATUS.ID,STATUS.NAME,SALARY,STATUS
FROM EMPDETAILS
LEFT JOIN STATUS
ON EMPDETAILS.ID = STATUS.ID
UNION
SELECT STATUS.ID,STATUS.NAME,SALARY,STATUS
FROM EMPDETAILS
RIGHT JOIN STATUS
ON EMPDETAILS.ID = STATUS.ID;

CREATE TABLE EMPLOYEES(
	EMP_ID INT PRIMARY KEY,
    NAME VARCHAR(20),
    DEPARTMENT_ID INT,
    SALARY INT
);
INSERT INTO employees (emp_id, name, department_id, salary) VALUES
(101, 'Alice', 1, 50000),
(102, 'Bob', 2, 60000),
(103, 'Charlie', 2, 70000),
(104, 'David', 3, 45000),
(105, 'Eve', NULL, 40000),
(106, 'Frank', 4, 55000),
(107, 'Grace', 2, 62000);

SELECT * FROM EMPLOYEES;


CREATE TABLE DEPARTMENTS(
	DEPARTMENT_ID INT PRIMARY KEY,
    DEPARTMENT_NAME VARCHAR(20)
);
INSERT INTO departments (department_id, department_name) VALUES
(1, 'HR'),
(2, 'Engineering'),
(3, 'Marketing'),
(4, 'Finance');

SELECT * FROM DEPARTMENTS; 

CREATE TABLE PROJECTS(
	PROJECT_ID INT PRIMARY KEY,
    PROJECT_NAME VARCHAR(20),
    EMP_ID INT
);
INSERT INTO projects (project_id, project_name, emp_id) VALUES
(201, 'Website Redesign', 102),
(202, 'Mobile App', 103),
(203, 'Ad Campaign', 104),
(204, 'Data Migration', 106),
(205, 'Backend Optimization', 107),
(206, 'Product Launch', NULL); 

SELECT * FROM PROJECTS;

-- RIGHT JOIN

SELECT DEPARTMENTS.DEPARTMENT_NAME,EMPLOYEES.NAME
FROM DEPARTMENTS
RIGHT JOIN EMPLOYEES
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID; 


SELECT PROJECTS.PROJECT_NAME,EMPLOYEES.NAME
FROM EMPLOYEES
RIGHT JOIN PROJECTS
ON EMPLOYEES.EMP_ID = PROJECTS.EMP_ID;

SELECT EMPLOYEES.NAME,DEPARTMENTS.DEPARTMENT_NAME
FROM DEPARTMENTS
RIGHT JOIN EMPLOYEES
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;

-- FULL 
SELECT E.EMP_ID,E.NAME,E.DEPARTMENT_ID,E.SALARY,D.DEPARTMENT_ID,D.DEPARTMENT_NAME
FROM EMPLOYEES AS E
LEFT JOIN DEPARTMENTS AS D
ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
UNION
SELECT E.EMP_ID,E.NAME,E.DEPARTMENT_ID,E.SALARY,D.DEPARTMENT_ID,D.DEPARTMENT_NAME
FROM EMPLOYEES AS E
RIGHT JOIN DEPARTMENTS AS D
ON E.DEPARTMENT_ID = D.DEPARTMENT_ID;

SELECT *
FROM EMPLOYEES AS E
LEFT JOIN
PROJECTS AS P
ON E.EMP_ID = P.EMP_ID
UNION
SELECT *
FROM EMPLOYEES AS E
RIGHT JOIN
PROJECTS AS P
ON E.EMP_ID = P.EMP_ID;

SELECT E.NAME,D.DEPARTMENT_NAME
FROM EMPLOYEES AS E
LEFT JOIN DEPARTMENTS AS D
ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
UNION
SELECT E.NAME,D.DEPARTMENT_NAME
FROM EMPLOYEES AS E
RIGHT JOIN DEPARTMENTS AS D
ON E.DEPARTMENT_ID = D.DEPARTMENT_ID;

-- JOINS + GROUPBY
SELECT D.DEPARTMENT_NAME,COUNT(*)
FROM DEPARTMENTS AS D
LEFT JOIN EMPLOYEES AS E 
ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
GROUP BY (D.DEPARTMENT_NAME);

SELECT D.DEPARTMENT_NAME,SUM(E.SALARY)
FROM EMPLOYEES AS E
JOIN DEPARTMENTS AS D
ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
GROUP BY D.DEPARTMENT_NAME;


SELECT E.NAME,D.DEPARTMENT_NAME,E.SALARY
FROM EMPLOYEES E
JOIN DEPARTMENTS D
ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
ORDER BY E.SALARY DESC;


SELECT E.NAME,P.PROJECT_NAME
FROM EMPLOYEES AS E
JOIN PROJECTS AS P
ON E.EMP_ID = P.EMP_ID
ORDER BY E.NAME ASC;


SELECT D.DEPARTMENT_NAME,COUNT(*)
FROM EMPLOYEES E
RIGHT JOIN DEPARTMENTS D
ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
GROUP BY D.DEPARTMENT_NAME
HAVING COUNT(*) > 1
ORDER BY COUNT(*) DESC;